var themehouse=themehouse||{};
themehouse.styleSwitch={autodetectInitialized:!1,styleToggleInitialized:!1,initAutodetect:function(){if(thstyleswitchConfig.autodetectEnabled&&!themehouse.styleSwitch.autodetectInitialized){themehouse.styleSwitch.autodetectInitialized=!0;if(null===themehouse.styleSwitch.getPreferredStyleType()){var a=thstyleswitchConfig[thstyleswitchConfig.currentStyleType+"Style"];a=themehouse.styleSwitch.buildStyleLinkTag(a.primaryCssUrl)+themehouse.styleSwitch.buildStyleLinkTag(a.additionalCssUrl)}else a=themehouse.styleSwitch.buildStyleLinkTag(thstyleswitchConfig.lightStyle.primaryCssUrl,
"light")+themehouse.styleSwitch.buildStyleLinkTag(thstyleswitchConfig.lightStyle.additionalCssUrl,"light")+themehouse.styleSwitch.buildStyleLinkTag(thstyleswitchConfig.darkStyle.primaryCssUrl,"dark")+themehouse.styleSwitch.buildStyleLinkTag(thstyleswitchConfig.darkStyle.additionalCssUrl,"dark");document.write(a)}},initStyleToggle:function(){$(".thstyleswitch_toggleSwitch__checkbox").click(function(a){a=$(a.target).is(":checked")?"dark":"light";themehouse.styleSwitch.switchStyle(a)})},switchStyle:function(a){var b=
thstyleswitchConfig[a+"Style"];console.log(b);themehouse.styleSwitch.updateStyleType(a,!1);var c=Object.keys(thstyleswitchConfig.originalCss),d=Object.keys(XF.config.css);c=themehouse.styleSwitch.getArrayDiff(c,d);var e=b.primaryCss.concat(b.additionalCss,c);$.get({url:b.switchStyleUrl,success:function(b,c,d){themehouse.styleSwitch.forceLoadStyleSheets(e,function(){$(".thstyleswitch-currentStyling").remove();$(".thstyleswitch-newStyling").addClass("thstyleswitch-currentStyling").removeClass("thstyleswitch-newStyling");
$(document).trigger("thstyleswitch:switch",[a])},"thstyleswitch-newStyling")}})},detectStyleType:function(){if(thstyleswitchConfig.autodetectEnabled){var a=themehouse.styleSwitch.getPreferredStyleType();a&&themehouse.styleSwitch.updateStyleType(a)}},buildStyleLinkTag:function(a,b){var c="";b&&(c='media="(prefers-color-scheme: '+b+')" ');return'<link rel="stylesheet" '+c+'href="'+a+'" />'},getPreferredStyleType:function(){var a=window.matchMedia("(prefers-color-scheme: dark)").matches,b=window.matchMedia("(prefers-color-scheme: light)").matches;
return a?"dark":b?"light":null},updateStyleType:function(a,b){b=b||!1;XF.config.url.css=thstyleswitchConfig[a+"Style"].cssUrl;thstyleswitchConfig.currentStyleType=a;"light"===a?$(".thstyleswitch_toggleSwitch__checkbox").attr("checked",!1):$(".thstyleswitch_toggleSwitch__checkbox").attr("checked",!0);if(b){var c=Object.keys(thstyleswitchConfig.originalCss),d=Object.keys(XF.config.css);c=themehouse.styleSwitch.getArrayDiff(c,d);0<c.length&&themehouse.styleSwitch.forceLoadStyleSheets(c,function(){$(".thstyleswitch-currentStyling").remove();
$(".thstyleswitch-newStyling").addClass("thstyleswitch-currentStyling").removeClass("thstyleswitch-newStyling");$(document).trigger("thstyleswitch:switch",[a])},"thstyleswitch-newStyling")}},forceLoadStyleSheets:function(a,b,c){a=a||[];c=c||"thstyleswitch_ajax_css";var d=a.length?1:0;if(d)if(a.length){var e=XF.config.url.css;e&&(e=e.replace("__SENTINEL__",a.join(",")));$.ajax({type:"GET",url:e,cache:!0,global:!1,dataType:"text",success:function(a){var b=XF.config.url.basePath;b&&(a=a.replace(/(url\(("|')?)([^"')]+)(("|')?\))/gi,
function(a,c,e,d,f,g){d.match(/^([a-z]+:|\/)/i)||(d=b+d);return c+d+f}));$('<style class="'+c+'">'+a+"</style>").appendTo("head")}}).always(function(){d--;0===d&&b&&b()})}else console.error("No CSS URL so cannot dynamically load CSS"),d--,0===d&&b&&b();else b&&b()},getArrayDiff:function(a,b){var c=[],d=[],e;for(e=0;e<a.length;e++)c[a[e]]=!0;for(e=0;e<b.length;e++)c[b[e]]?delete c[b[e]]:c[b[e]]=!0;for(var f in c)d.push(f);return d}};