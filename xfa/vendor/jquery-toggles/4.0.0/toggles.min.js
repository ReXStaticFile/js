(function(root){var factory=function($){var Toggles=root["Toggles"]=function(el,opts){var self=this;if(typeof opts==="boolean"&&el.data("toggles")){el.data("toggles").toggle(opts);return}var dataAttr=["on","drag","click","width","height","animate","easing","type","checkbox"];var dataOpts={};for(var i=0;i<dataAttr.length;i++){var opt=el.data("toggle-"+dataAttr[i]);if(typeof opt!=="undefined")dataOpts[dataAttr[i]]=opt}opts=$.extend({drag:true,click:true,text:{on:"ON",off:"OFF"},on:false,animate:250,easing:"swing",checkbox:null,clicker:null,width:0,height:0,type:"compact",event:"toggle"},opts||{},dataOpts);el.data("toggles",self);var active=!opts["on"];var selectType=opts["type"]==="select";var checkbox=$(opts["checkbox"]);var clicker=opts["clicker"]&&$(opts["clicker"]);var height=opts["height"]||el.height()||20;var width=opts["width"]||el.width()||50;el.height(height);el.width(width);var div=function(name){return $('<div class="toggle-'+name+'">')};var elSlide=div("slide");var elInner=div("inner");var elOn=div("on");var elOff=div("off");var elBlob=div("blob");var halfHeight=height/2;var onOffWidth=width-halfHeight;var text=opts["text"];elOn.css({height:height,width:onOffWidth,textIndent:selectType?"":-height/3,lineHeight:height+"px"}).html(text["on"]);elOff.css({height:height,width:onOffWidth,marginLeft:selectType?"":-halfHeight,textIndent:selectType?"":height/3,lineHeight:height+"px"}).html(text["off"]);elBlob.css({height:height,width:height,marginLeft:-halfHeight});elInner.css({width:width*2-height,marginLeft:selectType?0:-width+height});if(selectType){elSlide.addClass("toggle-select");el.css("width",onOffWidth*2);elBlob.hide()}elInner.append(elOn,elBlob,elOff);elSlide.html(elInner);el.html(elSlide);var doToggle=self.toggle=function(state,noAnimate,noEvent){if(active===state)return;active=self["active"]=!active;el.data("toggle-active",active);elOff.toggleClass("active",!active);elOn.toggleClass("active",active);checkbox.prop("checked",active);if(!noEvent)el.trigger(opts["event"],active);if(selectType)return;var margin=active?0:-width+height;elInner.stop().animate({marginLeft:margin},noAnimate?0:opts["animate"],opts["easing"])};var clickHandler=function(e){if(!el.hasClass("disabled")&&(e["target"]!==elBlob[0]||!opts["drag"])){doToggle()}};if(opts["click"]&&(!clicker||!clicker.has(el).length)){el.on("click",clickHandler)}if(clicker){clicker.on("click",clickHandler)}if(opts["drag"]&&!selectType){var diff;var slideLimit=(width-height)/4;var upLeave=function(e){el.off("mousemove");elSlide.off("mouseleave");elBlob.off("mouseup");if(!diff&&opts["click"]&&e.type!=="mouseleave"){doToggle();return}var overBound=active?diff<-slideLimit:diff>slideLimit;if(overBound){doToggle()}else{elInner.stop().animate({marginLeft:active?0:-width+height},opts["animate"]/2,opts["easing"])}};var wh=-width+height;elBlob.on("mousedown",function(e){if(el.hasClass("disabled"))return;diff=0;elBlob.off("mouseup");elSlide.off("mouseleave");var cursor=e.pageX;el.on("mousemove",elBlob,function(e){diff=e.pageX-cursor;var marginLeft;if(active){marginLeft=diff;if(diff>0)marginLeft=0;if(diff<wh)marginLeft=wh}else{marginLeft=diff+wh;if(diff<0)marginLeft=wh;if(diff>-wh)marginLeft=0}elInner.css("margin-left",marginLeft)});elBlob.on("mouseup",upLeave);elSlide.on("mouseleave",upLeave)})}doToggle(opts["on"],true,true)};$.fn["toggles"]=function(opts){return this.each(function(){new Toggles($(this),opts)})}};if(typeof define==="function"&&define["amd"]){define(["jquery"],factory)}else{factory(root["jQuery"]||root["Zepto"]||root["ender"]||root["$"]||$)}})(this);