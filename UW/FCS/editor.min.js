!function(d,k,h,l){var f;"use strict";XF.UWeditor=XF.extend(XF.Editor,{__backup:{startInit:"_startInit",isBbCodeView:"_isBbCodeView"},startInit:function(a){this.$target.parent().hasClass("uw_comment")?this._startInit(a):(this._startInit(a),f=this.ed)},insertContent:function(a,b){var c=f;this.isBbCodeView()?"undefined"!==typeof b&&c.bbCode.insertBbCode(b):(this.insertFocus(),c.html.insert(a),XF.Element.initialize(c.$el))},isBbCodeView:function(){return f.bbCode&&f.bbCode.isBbCodeView?f.bbCode.isBbCodeView():
!1},insertFocus:function(){XF.EditorHelpers.focus(f)}});XF.UWQuickEdit=XF.extend(XF.QuickEditClick,{__backup:{handleAjax:"_handleAjax",stopEditing:"_stopEditing"},handleAjax:function(a){this.$editorTarget.closest(".comment-inner").addClass("comment-editing");this._handleAjax(a)},stopEditing:function(a,b){this.$editorTarget.closest(".comment-inner").removeClass("comment-editing");this._stopEditing(a,b)}});XF.CommentQuoteClick=XF.Event.newHandler({eventNameSpace:"XFCommentQuoteClick",options:{quoteHref:null,
editor:".js-quickReply .js-editor"},init:function(){this.options.quoteHref||console.error("Must be initialized with a data-quote-href attribute.")},click:function(a){a.preventDefault();XF.ajax("POST",this.options.quoteHref,{},XF.proxy(this,"handleAjax"),{skipDefaultSuccess:!0});d(this.options.editor+" .editorPlaceholder").trigger("click");d(a.target).trigger("s2q:click");a=XF.findRelativeIf(this.options.editor,this.$target);XF.focusEditor(a)},handleAjax:function(a){var b=XF.findRelativeIf(this.options.editor+
" .js-editor",this.$target);b=XF.getEditorInContainer(b);var c=b.ed;b.isBbCodeView()||(b.focus(),c.html.insert(a.quoteHtml),XF.Element.initialize(c.$el));c.bbCode.insertBbCode(a.quote);b.scrollToCursor();b.scrollToCursorAfterPendingResize()}});XF.UWMultiQuote=XF.extend(XF.MultiQuote,{__backup:{removeFromMultiQuote:"_removeFromMultiQuote",initControls:"_initControls"},removeFromMultiQuote:function(a){var b=String(a).match(/^(\d+)-(\d+)$/);null==b?(b=String(a).match(/^(-\d+)-(\d+)$/),this.refreshMqData(),
b?(a=b[1],delete this.mqStorage[a][b[2]],this.getQuoteStoreCount(this.mqStorage[a])||delete this.mqStorage[a]):delete this.mqStorage[a],this.updateMultiQuote(),this.mqStorage[a]||(this.deselectMqControl(a),this.triggerCrossTabEvent("removed",a))):this._removeFromMultiQuote(a)},initControls:function(){if(".js-post"==this.options.messageSelector){var a=".tooltip--selectToQuote, article"+this.options.messageSelector,b=d(a).find(".js-multiQuote");d(h).on("click",a,XF.proxy(this,"controlClick"));var c=
this;b.each(function(){var e=d(this),g=e.data("messageId");c.mqStorage.hasOwnProperty(g)&&(e.addClass("is-selected"),e.data("mqAction","remove"))})}else this._initControls()}});XF.Element.extend("inline-mod",{toggleContainer:function(a,b){if(!a.hasClass("uw_fcs_inlineMod")){var c=b?"addClass":"removeClass";a.closest(this.options.toggleContainer)[c](this.options.containerClass)}},deselect:function(){this.setCookieValue([]);this.recalculateFromCookie();this.hideBar();d(".comment").removeClass("is-mod-selected");
d(".message-inner.message").removeClass("is-mod-selected")}});XF.UWSelectToQuote=XF.extend(XF.SelectToQuote,{createButton:function(a,b){var c=a.closest(this.options.messageSelector),e=d("<span />"),g=c.find(".actionBar-action.js-multiQuote:first").clone();g.length&&(g.attr("title","").removeClass("is-selected").data("mqAction","add").css({marginLeft:0,background:"transparent"}).on("s2q:click",XF.proxy(this,"buttonClicked")),e.append(g),e.append(h.createTextNode(" | ")));c=c.find('.actionBar-action[data-xf-click="quote"]:first').attr("title",
"").clone().css({marginLeft:0}).on("s2q:click",XF.proxy(this,"buttonClicked"));e.append(c);this.tooltip=new XF.TooltipElement(e,{html:!0,placement:"bottom"});this.tooltipId=b}});XF.UWGuestUsername=XF.extend(XF.GuestUsername,{__backup:{change:"_change"},change:function(){this._change();var a=this.$target;d('*[data-xf-init="guest-username"]').val(a.val())}});XF.Event.register("click","commentquote","XF.CommentQuoteClick");XF.Element.register("editor-test","XF.UWeditor");XF.Element.register("quick-edit",
"XF.UWQuickEdit");XF.Element.register("multi-quote","XF.UWMultiQuote");XF.Element.register("select-to-quote","XF.UWSelectToQuote");XF.Element.register("guest-username","XF.UWGuestUsername")}(jQuery,window,document);