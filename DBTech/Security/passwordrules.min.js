var DBTech=window.DBTech||{};DBTech.Security=DBTech.Security||{};
!function(e,g,h,k){DBTech.Security.PasswordRules=XF.Element.newHandler({options:{container:"< li | ul, ol, dl",controls:"input, select, textarea, button, .js-attachmentUpload",rules:{},templateRules:".js-passwordRules"},$container:null,$form:null,$input:null,init:function(){this.$container=XF.findRelativeIf(this.options.container,this.$target);this.$container.length||console.error("Could not find the disabler control container");this.$input=this.$target;this.$input.parent().after(e(this.options.templateRules).show());
var a=this.$target,c=a.closest("form");if(c.length)c.on("reset",XF.proxy(this,"formReset"));a.on("focus input",XF.proxy(this,"change"));a.on("control:enabled control:disabled",XF.proxy(this,"recalculateAfter"));this.$container.one("editor:init",XF.proxy(this,"recalculateAfter"));this.recalculate()},change:function(){this.recalculateAfter()},formReset:function(a){this.recalculateAfter()},recalculateAfter:function(){var a=this;setTimeout(function(){a.recalculate()},0)},recalculate:function(){var a=
this.$container,c=this.$target;c=a.find(this.options.controls).not(c);var d=this.$target.val(),f=!0;e(this.options.templateRules).find("div > i").each(function(){var a=e(this),b=a.data("security-rule");if(!b)return!0;switch(b){case "length":b=d.length>=a.data("param");break;case "lowercase":b=null!==d.match(/[a-z]+/);break;case "uppercase":b=null!==d.match(/[A-Z]+/);break;case "numbers":b=null!==d.match(/[0-9]+/);break;case "symbols":b=null!==d.match(/\W+/);break;default:b=!1}b?a.removeClass("passwordRule--bad fa-times").addClass("passwordRule--good fa-check"):
a.removeClass("passwordRule--good fa-check").addClass("passwordRule--bad fa-times");f=f&&b});f?(a.prop("disabled",!1).removeClass("is-disabled"),c.prop("disabled",!1).removeClass("is-disabled").each(function(a,b){var c=e(b);c.is("select.is-readonly")&&c.prop("disabled",!0)}).trigger("control:enabled")):(a.prop("disabled",!0).addClass("is-disabled"),c.prop("disabled",!0).addClass("is-disabled").trigger("control:disabled").each(function(a,b){var c=e(b),d=c.data("disabled");null!==d&&"undefined"!==typeof d&&
c.val(d)}))}});XF.Element.register("dbtech-security-password-rules","DBTech.Security.PasswordRules")}(jQuery,window,document);