/*
 kl/editor-manager/extend.js
 License https://creativecommons.org/licenses/by-nc-nd/4.0/legalcode
 Copyright 2017 Lukas Wieditz
*/
(function(a,m,k,n){var l=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};a.FE.DefineIcon("xfKLEMiSpoiler",{NAME:"eye-slash"});a.FE.RegisterCommand("xfKLEMiSpoiler",{title:"Inline Spoiler",icon:"xfKLEMiSpoiler",undo:!0,focus:!0,callback:function(){var e=this;XF.EditorHelpers.loadDialog(e,"spoiler",function(b){a("#editor_spoiler_submit").click(function(c){c.preventDefault();e.selection.restore();XF.EditorHelpers.insertKLEMiSpoiler(e,a("#editor_spoiler_title").val());
b.hide()})},function(b){var c=a("#editor_spoiler_title").val("");setTimeout(function(){c.autofocus()},0)},!0)}});a.FE.DefineIcon("klEMParseHtml",{NAME:"code"});a.FE.RegisterCommand("klEMParseHtml",{title:"HTML",icon:"klEMParseHtml",undo:!0,focus:!0,callback:function(){XF.EditorHelpers.wrapSelectionText(this,"[PARSEHTML]","[/PARSEHTML]",!0)}});XF.EditorHelpers.insertKLEMiSpoiler=function(a,b){XF.EditorHelpers.wrapSelectionText(a,b?'[ISPOILER="'+b+'"]':"[ISPOILER]","[/ISPOILER]",!0)};a(k).on("editor:config",
function(e,b,c){try{var d=a.parseJSON(a(".js-klEditorDropdowns").first().html())||{}}catch(g){console.error(g),d=[]}try{var h=a.parseJSON(a(".js-klEditorConfig").first().html())||{};l(b,h)}catch(g){console.error(g)}for(var f in d)d[f].buttons.length&&function(b,c){a.FE.DefineIcon(c,{NAME:b.icon});a.FE.RegisterCommand(c,{type:"dropdown",title:b.title,icon:c,undo:!1,focus:!0,id:f,html:function(){var c='<ul class="fr-dropdown-list">',d=b.buttons,e;for(e in d){var f=d[e];var g=a.FE.COMMANDS[f];c+='<li><a class="fr-command" data-cmd="'+
f+'">'+this.icon.create(g.icon||f)+"&nbsp;&nbsp;"+this.language.translate(g.title)+"</a></li>"}return c+"</ul>"}})}(d[f],f)});a(k).on("editor:init",function(e,b,c){try{var d=a.parseJSON(a(".js-klEditorConfig").first().html())||{}}catch(h){console.error(h),d={colorTypes:{color:!0,bgcolor:!1}}}if(d.colorTypes.bgcolor&&d.colorTypes.color)b.events.on("popups.show.colors.picker",function(){a(b.popups.get("colors.picker")).find(".fr-colors-buttons").css("display","block")});if(!d.colorTypes.color)b.events.on("popups.show.colors.picker",
function(){a(b.popups.get("colors.picker")).find(".fr-colors-tab").toggleClass("fr-selected-tab");a(b.popups.get("colors.picker")).find(".fr-color-set").toggle()});b.$tb.find("[data-cmd=align][data-param1=justify]").closest("li").css("display","block")})})(jQuery,window,document);